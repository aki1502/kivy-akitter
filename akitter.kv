#:kivy 1.11.1


AkitterRoot:
    
<Separator@Widget>:
    size_hint_y: None
    height: sp(1)
    color: 0.467, 0.533, 0.600 # lightslategray
    canvas:
        Color:
            rgb: self.color or (0.467, 0.533, 0.600)
        Rectangle:
            pos: self.pos
            size: self.size

<Akeet@BoxLayout>:
    color: 0.941, 0.973, 1, 1 #aliceblue
    icon: "./images/anonymous.png"
    author: "aki1502"
    text: "こんにちは、世界！"
    date: "1998/02/21 20:00"
    font_size: self.width/sp(37)

    orientation: "vertical"

    canvas.before:
        Color:
            rgba: 0.439, 0.502, 0.565, 1 #slategray
        Rectangle:
            pos: self.pos
            size: self.size

    Separator:

    BoxLayout:
        orientation: "horizontal"

        Image:
            source: root.icon
            size_hint_x: None
            width: self.height+sp(20)

        BoxLayout:
            orientation: "vertical"

            BoxLayout:
                orientation: "horizontal"

                Label:
                    markup: True
                    text: "[color=EF810F][ref=athr]"+root.author+"[/ref][/color]"
                    on_ref_press: app.root.ids.akeetform.user_detail(root.author)
                    font_size: root.font_size
                    text_size: self.size
                    halign: "left"

                Label:
                    text: root.date
                    font_size: root.font_size
                    text_size: self.size
                    halign: "right"
                    padding: sp(10), 0

            Label:
                text: root.text
                font_size: root.font_size
                text_size: self.size
                halign: "left"

            Separator:
                height: sp(10)
                color: 0.439, 0.502, 0.565 #slategray

<CompositionLabel>:
    size_hint_x: None
    size_hint_y: None
    width: self.font_size * (len(self.text)-7)
    height: self.font_size
    color: 0,0,0,1
    markup: True

<ErrorPopup>:
    title: "error"
    size_hint: None, None
    size: sp(300), sp(300)

    BoxLayout:
        orientation: "vertical"

        Label:
            text: root.text

        Button:
            text: "quit"
            on_release: root.dismiss()
            size_hint_y: 0.3

<AkitterRoot>:
    canvas.before:
        Color:
            rgba: 0.467, 0.533, 0.600, 1 # lightslategray
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: "vertical"
        size: root.size

        ActionBar:

            ActionView:
                use_separator: True

                ActionPrevious:
                    title: "Akitter"
                    color: 0.937, 0.506, 0.059, 1 #orange
                    app_icon: "./images/Akitter.png"
                    on_release: 
                        t_manager.transition.direction = "right"
                        t_manager.current = "menuscreen"

                ActionButton:
                    text: "Sign in"
                    color: 0.937, 0.506, 0.059, 1 #orange
                    on_release:
                        t_manager.transition.direction = "left"
                        t_manager.current = "signinform"

                ActionButton:
                    text: "Sign up"
                    color: 0.937, 0.506, 0.059, 1 #orange
                    on_release:
                        t_manager.transition.direction = "left"
                        t_manager.current = "signupform"

        TransitionManager:
            id: t_manager

            AkeetForm:
                id: akeetform

<MenuScreen>:
    Image:
        source: "./images/menu.png"
        size_hint: None, None
        size: root.height*2, root.height
        pos: root.width/2-root.height, 0

<Form@AnchorLayout>:
    label_text: ""
    password: False

    textinput_font_size: 35
    textinput_height: sp(50)
    textinput_width: sp(500)

    text: textinput.text

    BoxLayout:
        orientation: "vertical"
        size_hint_x: None
        width: root.textinput_width

        Label:
            text: root.label_text
            font_size: root.textinput_font_size

        TextInput:
            id: textinput
            size_hint_y: None
            height: root.textinput_height
            font_size: root.textinput_font_size
            multiline: False
            password: root.password
            cursor_color: 0.937, 0.506, 0.059, 0.8 # orange
            selection_color: 0.937, 0.506, 0.059, 0.221 # orange


<SigninForm>:
    BoxLayout:
        orientation: "vertical"

        Form:
            id: username
            label_text: "UserName"

        Form:
            id: password
            label_text: "Password"
            password: True

        Widget:

        AnchorLayout:
            Button:
                size_hint: None, None
                size: sp(300), sp(80)
                text: "Sign in"
                font_size: 35
                on_release: root.signin(username.text, password.text)

<SignupForm>:
    BoxLayout:
        orientation: "vertical"

        Form:
            id: username
            text: "UserName"

        Form:
            id: passwordone
            text: "Password"
            password: True

        Form:
            id: passwordtwo
            text: "Password(again)"
            password: True

        AnchorLayout:
            Button:
                size_hint: None, None
                size: sp(300), sp(80)
                text: "Sign up"
                font_size: 35
                on_release: root.signup(username.text, passwordone.text, passwordtwo.text)

<AkeetForm>:
    textinput_font_size: self.width/sp(35)
    textinput_height: self.width/sp(26)+sp(10)
    sendbutton_width: self.width/sp(12)
    orientation: "vertical"

    AkeetColumn:
        viewclass: "Akeet"
        scroll_y: 0

        size_hint_y: None
        height: root.height-root.textinput_height
        pos: (0, root.textinput_height)
        padding: 0, sp(2), 0, 0

        RecycleBoxLayout:
            default_size: None, root.width/10
            default_size_hint: 1, None
            size_hint_y: None
            height: self.minimum_height
            orientation: 'vertical'


    BoxLayout:
        orientation: "horizontal"
        size_hint_y: None
        height: root.textinput_height

        FloatLayout:
            size_hint_x: None
            width: root.width-root.sendbutton_width

            TextInputIME:
                id: textinput
                font_size: root.textinput_font_size
                composition_window: cmp_window
                text: root.ipt
                multiline: True
                on_touch_up: self.select_all()
                cursor_blink: True
                cursor_color: 0.937, 0.506, 0.059, 0.8 # orange
                selection_color: 0.937, 0.506, 0.059, 0.221 # orange
                pos: (sp(2), 0)

            CompositionLabel:
                id: cmp_window
                font_size: root.textinput_font_size
                textinput: textinput
                x: textinput.cursor_pos[0]
                y: textinput.cursor_pos[1] - self.height

        Button:
            font_size: root.textinput_font_size
            text: "[send]"
            color: 0.937, 0.506, 0.059, 1 #orange
            size_hint_x: None
            width: root.sendbutton_width
            on_release: root.send()

